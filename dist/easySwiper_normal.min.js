"use strict";!function(t,i){if("function"==typeof define&&define.amd)define(["exports","module"],i);else if("undefined"!=typeof exports&&"undefined"!=typeof module)i(exports,module);else{var s={exports:{}};i(s.exports,s),t.easySwiper=s.exports}}(this,function(t,i){function s(t){this.$el=t.element,this.$childs=Array.prototype.slice.call(this.$el.children),this.childNum=this.$childs.length,this.initNum=t.initNum||0,this.params=t,this.curPos=0,this.curIdx=0,this.x=this.y=null,this.delta=null,this.now=null,this.canscroll=!1,this.canswipe=!1,this.baseWidth=document.body.clientWidth,this.totalWidth=this.baseWidth*this.childNum,this._init()._emit("onInit",{dom:this.$childs[this.curIdx],num:this.curIdx})}var e={timeHandle:"",addOnce:function(t,i,s){var h=function h(){e.timeHandle&&clearTimeout(e.timeHandle),e.timeHandle=setTimeout(function(){s.apply(this,arguments)},500),e.remove(t,i,h)};t.addEventListener(i,h,!1)},remove:function(t,i,s){t.removeEventListener(i,s,!1)}};s.prototype={_init:function(){return this._initStyle()._bindEvents(),this._initPage(this.initNum,"first"),this._resetStyle(),this},_initStyle:function(){var t=this;return this.$el.style.width=this.totalWidth+"px",this.$childs.forEach(function(i){i.style.width=t.baseWidth+"px"}),this},_emit:function(t,i){this.params[t]&&this.params[t](i)},_bindEvents:function(){var t=this;"touchstart touchmove touchend touchcancel".split(" ").forEach(function(i){t.$el.addEventListener(i,t["_"+i].bind(t),!1)})},_setIndex:function(t){this.curIdx!=t&&(this.curIdx<t?this.curPos=this.curPos-Math.abs(this.curIdx-t)*this.baseWidth:this.curPos=this.curPos+Math.abs(this.curIdx-t)*this.baseWidth,this.curIdx=t)},_initPage:function(t,i){var s=this;if(this.delta=null,this.canscroll=this.canswipe=!1,t!=this.curIdx&&(this._setIndex(t),"string"!=typeof i||!i)){this._emit("onChangeBegin",{dom:this.$childs[this.curIdx],num:this.curIdx});var h=function(){"function"==typeof i&&i(),s._emit("onChangeEnd",{dom:s.$childs[s.curIdx],num:s.curIdx})};e.addOnce(this.$el,"webkitTransitionEnd",h)}},_resetStyle:function(t){var i=this.curIdx;this.$el.style.webkitTransform="translateX("+-i*this.baseWidth+"px)"},_touchstart:function(t){this.now=Date.now(),this.x=t.touches[0].pageX,this.y=t.touches[0].pageY},_touchmove:function(t){if(!(this.canscroll||t.touches.length>1)){var i=t.touches[0];if(this.delta=i.pageX-this.x,!this.canswipe){if(Math.abs(i.pageY-this.y)>Math.abs(this.delta))return this.canscroll=!0,void(this.canswipe=!1);this.canswipe=!0}if(t.preventDefault(),t.stopPropagation(),i.pageY<0)return void this._touchend();this._emit("onMoving",{num:this.curIdx,delta:this.delta}),this._translate(this.$el,this.delta,0)}},_touchcancel:function(t){this._touchend()},_touchend:function(t){if(this.canscroll)return void(this.canscroll=!1);if(this.delta){var i=this.baseWidth/3,s=this.delta,e=s/(Date.now()-this.now);return(s>i||e>.5)&&this.curPos<0?void this._doAnimate("prev"):(-s>i||e<-.5)&&this.curPos>-(this.totalWidth-this.baseWidth)?void this._doAnimate("next"):void this._doAnimate("current")}}},s.prototype.gotoPage=function(t){if(!(t<0||t>this.childNum-1||t==this.curIdx)){var i=this.curIdx;i>t&&this._doAnimate("prev",{targetIdx:t}),i<t&&this._doAnimate("next",{targetIdx:t})}},s.prototype._translate=function(t,i,s){t.style.webkitTransform="translateX("+((s?0:this.curPos)+i)+"px)",t.style.webkitTransition="-webkit-transform "+s+"ms linear"},s.prototype._doAnimate=function(t,i){var s=this.curIdx;"prev"==t?(this._translate(this.$el,i?this.curPos+Math.abs(i.targetIdx-s)*this.baseWidth:this.curPos+this.baseWidth,300),this._initPage(i?i.targetIdx:s-1)):"next"==t?(this._translate(this.$el,i?-i.targetIdx*this.baseWidth:-(s+1)*this.baseWidth,300),this._initPage(i?i.targetIdx:s+1)):(this._translate(this.$el,this.curPos,300),this._initPage(s))},i.exports=s});